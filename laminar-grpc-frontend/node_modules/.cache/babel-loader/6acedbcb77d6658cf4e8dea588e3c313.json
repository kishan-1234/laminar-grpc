{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar React = require('react');\n\nvar ReactRelayContext = require('./ReactRelayContext');\n\nvar useLayoutEffect = React.useLayoutEffect,\n    useState = React.useState,\n    useRef = React.useRef,\n    useMemo = React.useMemo;\n\nvar _require = require('relay-runtime'),\n    createOperationDescriptor = _require.createOperationDescriptor,\n    deepFreeze = _require.deepFreeze,\n    getRequest = _require.getRequest;\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nfunction useDeepCompare(value) {\n  var latestValue = React.useRef(value);\n\n  if (!areEqual(latestValue.current, value)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      deepFreeze(value);\n    }\n\n    latestValue.current = value;\n  }\n\n  return latestValue.current;\n}\n\nfunction ReactRelayLocalQueryRenderer(props) {\n  var environment = props.environment,\n      query = props.query,\n      variables = props.variables,\n      render = props.render;\n  var latestVariables = useDeepCompare(variables);\n  var operation = useMemo(function () {\n    var request = getRequest(query);\n    return createOperationDescriptor(request, latestVariables);\n  }, [query, latestVariables]);\n  var relayContext = useMemo(function () {\n    return {\n      environment: environment\n    };\n  }, [environment]); // Use a ref to prevent rendering twice when data changes\n  // because of props change\n\n  var dataRef = useRef(null);\n\n  var _useState = useState(null),\n      forceUpdate = _useState[1];\n\n  var cleanupFnRef = useRef(null);\n  var snapshot = useMemo(function () {\n    environment.check(operation);\n    var res = environment.lookup(operation.fragment);\n    dataRef.current = res.data; // Run effects here so that the data can be retained\n    // and subscribed before the component commits\n\n    var retainDisposable = environment.retain(operation);\n    var subscribeDisposable = environment.subscribe(res, function (newSnapshot) {\n      dataRef.current = newSnapshot.data;\n      forceUpdate(dataRef.current);\n    });\n    var disposed = false;\n\n    function nextCleanupFn() {\n      if (!disposed) {\n        disposed = true;\n        cleanupFnRef.current = null;\n        retainDisposable.dispose();\n        subscribeDisposable.dispose();\n      }\n    }\n\n    if (cleanupFnRef.current) {\n      cleanupFnRef.current();\n    }\n\n    cleanupFnRef.current = nextCleanupFn;\n    return res;\n  }, [environment, operation]);\n  useLayoutEffect(function () {\n    var cleanupFn = cleanupFnRef.current;\n    return function () {\n      cleanupFn && cleanupFn();\n    };\n  }, [snapshot]);\n  return /*#__PURE__*/React.createElement(ReactRelayContext.Provider, {\n    value: relayContext\n  }, render({\n    props: dataRef.current\n  }));\n}\n\nmodule.exports = ReactRelayLocalQueryRenderer;","map":{"version":3,"sources":["/Users/gayatri/work/laminar-grpc/frontend/node_modules/react-relay/lib/ReactRelayLocalQueryRenderer.js"],"names":["React","require","ReactRelayContext","useLayoutEffect","useState","useRef","useMemo","_require","createOperationDescriptor","deepFreeze","getRequest","areEqual","useDeepCompare","value","latestValue","current","process","env","NODE_ENV","ReactRelayLocalQueryRenderer","props","environment","query","variables","render","latestVariables","operation","request","relayContext","dataRef","_useState","forceUpdate","cleanupFnRef","snapshot","check","res","lookup","fragment","data","retainDisposable","retain","subscribeDisposable","subscribe","newSnapshot","disposed","nextCleanupFn","dispose","cleanupFn","createElement","Provider","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar React = require('react');\n\nvar ReactRelayContext = require('./ReactRelayContext');\n\nvar useLayoutEffect = React.useLayoutEffect,\n    useState = React.useState,\n    useRef = React.useRef,\n    useMemo = React.useMemo;\n\nvar _require = require('relay-runtime'),\n    createOperationDescriptor = _require.createOperationDescriptor,\n    deepFreeze = _require.deepFreeze,\n    getRequest = _require.getRequest;\n\nvar areEqual = require(\"fbjs/lib/areEqual\");\n\nfunction useDeepCompare(value) {\n  var latestValue = React.useRef(value);\n\n  if (!areEqual(latestValue.current, value)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      deepFreeze(value);\n    }\n\n    latestValue.current = value;\n  }\n\n  return latestValue.current;\n}\n\nfunction ReactRelayLocalQueryRenderer(props) {\n  var environment = props.environment,\n      query = props.query,\n      variables = props.variables,\n      render = props.render;\n  var latestVariables = useDeepCompare(variables);\n  var operation = useMemo(function () {\n    var request = getRequest(query);\n    return createOperationDescriptor(request, latestVariables);\n  }, [query, latestVariables]);\n  var relayContext = useMemo(function () {\n    return {\n      environment: environment\n    };\n  }, [environment]); // Use a ref to prevent rendering twice when data changes\n  // because of props change\n\n  var dataRef = useRef(null);\n\n  var _useState = useState(null),\n      forceUpdate = _useState[1];\n\n  var cleanupFnRef = useRef(null);\n  var snapshot = useMemo(function () {\n    environment.check(operation);\n    var res = environment.lookup(operation.fragment);\n    dataRef.current = res.data; // Run effects here so that the data can be retained\n    // and subscribed before the component commits\n\n    var retainDisposable = environment.retain(operation);\n    var subscribeDisposable = environment.subscribe(res, function (newSnapshot) {\n      dataRef.current = newSnapshot.data;\n      forceUpdate(dataRef.current);\n    });\n    var disposed = false;\n\n    function nextCleanupFn() {\n      if (!disposed) {\n        disposed = true;\n        cleanupFnRef.current = null;\n        retainDisposable.dispose();\n        subscribeDisposable.dispose();\n      }\n    }\n\n    if (cleanupFnRef.current) {\n      cleanupFnRef.current();\n    }\n\n    cleanupFnRef.current = nextCleanupFn;\n    return res;\n  }, [environment, operation]);\n  useLayoutEffect(function () {\n    var cleanupFn = cleanupFnRef.current;\n    return function () {\n      cleanupFn && cleanupFn();\n    };\n  }, [snapshot]);\n  return /*#__PURE__*/React.createElement(ReactRelayContext.Provider, {\n    value: relayContext\n  }, render({\n    props: dataRef.current\n  }));\n}\n\nmodule.exports = ReactRelayLocalQueryRenderer;"]},"metadata":{},"sourceType":"script"}